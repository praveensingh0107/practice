package intbit.dp;

import java.util.List;

/**
 * Best Time to Buy and Sell Stocks II
 * Asked in:
 * Amazon
 * Facebook
 * Say you have an array, A, for which the ith element is the price of a given stock on day i.
 * <p>
 * Design an algorithm to find the maximum profit.
 * <p>
 * You may complete as many transactions as you like (i.e., buy one and sell one share of the stock multiple times).
 * <p>
 * However, you may not engage in multiple transactions at the same time (ie, you must sell the stock before you buy again).
 * <p>
 * Input Format:
 * <p>
 * The first and the only argument is an array of integer, A.
 * Output Format:
 * <p>
 * Return an integer, representing the maximum possible profit.
 * Constraints:
 * <p>
 * 1 <= len(A) <= 1e5
 * 1 <= A[i] <= 1e7
 * Example :
 * <p>
 * Input 1:
 * A = [1, 2, 3]
 * <p>
 * Output 1:
 * 2
 * <p>
 * Explanation 1:
 * => Buy a stock on day 0.
 * => Sell the stock on day 1. (Profit +1)
 * => Buy a stock on day 1.
 * => Sell the stock on day 2. (Profit +1)
 * <p>
 * Overall profit = 2
 * <p>
 * Input 2:
 * A = [5, 2, 10]
 * <p>
 * Output 2:
 * 8
 * <p>
 * Explanation 2:
 * => Buy a stock on day 1.
 * => Sell the stock on on day 2. (Profit +8)
 * <p>
 * Overall profit = 8
 */
public class BestTimeToBuyAndSellStock2 {
    public int maxProfit(final List<Integer> A) {
        int n = A.size();
        if (A == null || n < 2)
            return 0;
        int minVal = A.get(0);
        int maxProfit = 0;
        int i;
        for (i = 1; i < n; i++) {
            if (A.get(i) <= minVal) {
                maxProfit = maxProfit + (A.get(i - 1) - minVal);
                minVal = A.get(i);
            }
        }
        maxProfit = maxProfit + A.get(i - 1) - minVal;
        return maxProfit;
    }

    public int maxProfitDP(final List<Integer> A) {
        if (A == null || A.size() < 2)
            return 0;
        int n = A.size();
        int[][] dp = new int[n][n];
        for (int i = 0; i < n; i++) {
            dp[i][i] = 0;
        }
        for (int len = 2; len <= n; len++) {
            for (int l = 0; l <= n - len; l++) {
                int r = l + len - 1;
                dp[l][r] = Math.max(0, A.get(r) - A.get(l));
                for (int i = l + 1; i < r; i++) {
                    dp[l][r] = Math.max(dp[l][r], dp[l][i] + dp[i][r]);
                }
            }
        }
        return dp[0][n - 1];
    }

    private int maxProfitRec(List<Integer> A) {
        if (A == null || A.size() < 2)
            return 0;
        return maxProfitRec(A, 0, A.size() - 1);
    }

    private int maxProfitRec(List<Integer> A, int l, int r) {
        if (l == r)
            return 0;
        int max = Math.max(0, A.get(r) - A.get(l));
        for (int i = l + 1; i < r; i++) {
            max = Math.max(max, maxProfitRec(A, l, i) + maxProfitRec(A, i, r));
        }
        return max;
    }

    public static void main(String[] args) {
        List<Integer> list = List.of(1, 2, 3);
        BestTimeToBuyAndSellStock2 obj = new BestTimeToBuyAndSellStock2();
        System.out.println(obj.maxProfitRec(list));
        System.out.println(obj.maxProfitRec(List.of(5, 2, 10)));
        System.out.println(obj.maxProfitDP(list));
        System.out.println(obj.maxProfitDP(List.of(5, 1, 3, 7, 6, 8, 5, 7)));
        List<Integer> list1 = List
                .of(9743910, 7076531, 5792092, 4842436, 8495908, 9862065, 9518416, 9465107, 6533729,
                        1042380, 2585007, 8675902, 618823, 2876075, 8505875, 7610299, 1168725,
                        7575072, 9046984, 3997983, 1898106, 2122540, 5687874, 8241770, 8307630,
                        5418812, 5890695, 693690, 1011785, 9117715, 8255244, 7404917, 302671,
                        7450364, 4958977, 7672846, 2064163, 4699566, 4972152, 1124849, 1280749,
                        5579829, 2716351, 6941330, 2376574, 1933715, 246837, 7120840, 2537401,
                        7438793, 67481, 3170568, 5187999, 5764119, 5234431, 3893982, 1971065,
                        5759762, 1116074, 5340204, 1350341, 9392719, 5605248, 6937938, 444152,
                        7303702, 9274558, 97626, 1892162, 889933, 8665397, 2606273, 2029706,
                        9048876, 6741918, 8674744, 7951760, 918659, 4698399, 7022080, 8172488,
                        5432426, 2147210, 316522, 8200077, 2944859, 7995889, 5621195, 6112896,
                        9491619, 1641538, 8659176, 6269801, 2253205, 1528255, 2613135, 9968118,
                        4173082, 8549644, 3235808, 6986368, 9446606, 1283966, 6590827, 5789507,
                        7866683, 9163696, 5360926, 2110525, 4378169, 5703610, 4699104, 1959132,
                        8166746, 9816907, 1444639, 5560246, 2817862, 4392565, 6589234, 4092875,
                        68791, 5396398, 486223, 6613002, 1867307, 6743265, 331284, 7784239, 2079276,
                        35540, 2274413, 1089803, 9739730, 9113353, 1854998, 5059280, 1917944,
                        6755141, 1502670, 4834546, 75342, 7340792, 5015249, 7972624, 2292084,
                        811500, 7778480, 7478844, 4389330, 9161479, 2992285, 5502309, 9813622,
                        4391902, 7226330, 6955904, 6935053, 3257162, 5852401, 3851328, 5325024,
                        3844200, 6678496, 9389687, 5450862, 785663, 2019419, 3430054, 9320488,
                        9698156, 2275781, 9004861, 5115919, 8834218, 5222334, 6601734, 6107934,
                        9354682, 4420876, 1491289, 6727655, 8716862, 6185021, 2874348, 3071463,
                        1580840, 503572, 8019563, 7868389, 1157435, 7142852, 5758826, 4107744,
                        5134798, 4764338, 1992964, 3816218, 3690448, 7381922, 6766420, 9141225,
                        8163414, 967534, 7441642, 8306726, 5093540, 2618181, 3266369, 9372284,
                        1921355, 9363002, 7017724, 3567782, 7822468, 1708169, 1552787, 1625637,
                        2215528, 5952465, 1022438, 6204479, 206198, 9626479, 6182922, 8339280,
                        8637289, 4443428, 1142312, 5788067, 7666815, 468274, 9100232, 8666756,
                        1383162, 7865874, 6929646, 9208166, 6623301, 5643792, 7417282, 1767309,
                        441751, 8853459, 8311295, 135188, 1981265, 5349397, 5525191, 2316727,
                        5280854, 2461570, 4641607, 2519031, 6674433, 746746, 5959057, 8671224,
                        8791126, 2970743, 5458969, 3952274, 6577086, 4163334, 7477646, 3658775,
                        3311120, 7407835, 4090523, 3387185, 368530, 9505215, 4452974, 6450173,
                        6336503, 2625615, 934824, 1276001, 4982551, 6876528, 3814237, 187122,
                        7236043, 1927585, 2793621, 7367617, 939895, 7928320, 1947314, 438293,
                        7438078, 3127394, 8021789, 6526744, 2994897, 2514133, 19659, 8364760,
                        6725773, 3703872, 9887123, 9158318, 2388320, 2939992, 4741195, 7362698,
                        7431229, 8255928, 4419364, 5366896, 784610, 8803190, 4214120, 6046778,
                        8897104, 6334276, 3238241, 8976722, 1409969, 2450679, 49334, 193770,
                        7281053, 4014872, 7795522, 6905996, 8456484, 792625, 8232092, 456142,
                        722971, 3075891, 158271, 6609818, 9839467, 4968837, 3273408, 9518493,
                        5418444, 2492561, 6127283, 7045640, 7620202, 720374, 8004087, 7290736,
                        2392332, 369669, 4074625, 9037980, 1476622, 3245917, 3917030, 3464196,
                        536235, 2892118, 5709813, 6730841, 8378190, 7637118, 6095876, 9636571,
                        8942097, 3685307, 3353050, 6250708, 7139532, 4649793, 1021993, 1696648,
                        7796136, 5089251, 385521, 1303595, 6108682, 354842, 9543243, 1508093,
                        7844866, 2098698, 4116158, 4234587, 8518968, 5884192, 9887919, 7220107,
                        6583608, 8437776, 283678, 586731, 7987031, 9562255, 6414156, 3491192,
                        7106416, 4594403, 9198875, 3673645, 50845, 7725387, 7318516, 6172018,
                        6119868, 9511682, 8693296, 7526730, 4758715, 9150908, 6571483, 6556281,
                        1583668, 3669059, 5527911, 1561425, 1549519, 1390568, 5457231, 972383,
                        9000389, 3423073, 7958014, 5704524, 3744196, 6451984, 8701557, 3466060,
                        8745753, 1841841, 6630613, 7173752, 4112588, 3521391, 4065187, 6674811,
                        8431601, 3775234, 2736187, 4419379, 8049737, 1233428, 7376799, 2352082,
                        7595703, 3361430, 1954825, 1838406, 8094141, 4474266, 9614580, 3255774,
                        2732949, 7622412, 5433105, 9759226, 5118897, 573373, 5584780, 2637802,
                        3919965, 772935, 9733031, 6252997, 3628342, 6151053, 8567791, 2412669,
                        5046268, 763937, 9516755, 7337417, 9212504, 1784742, 8987617, 2091480,
                        7934990, 6069794, 6678460, 1718526, 6095416, 3569046, 11607, 5171051,
                        384952, 7529542, 7802340, 7247847, 2987794, 3428518, 7157825, 6550750,
                        2872424, 7530239, 9430986, 2288315, 7349483, 759768, 4433074, 2555674,
                        9801260, 8017210, 163269, 6903480, 2229478, 3583648, 4684576, 7044240,
                        855235, 8731338, 5412918, 8757827, 675108, 9803070, 6007141, 968584,
                        4763887, 2454819, 6727025, 9816368, 3097879, 7868803, 9601175, 1549236,
                        5627482, 7622452, 6252829, 7747651, 8212746, 2165005, 7021151, 244491,
                        337802, 954137, 5218960, 5591435, 2290522, 2128233, 4783337, 7625630,
                        1801711, 7623013, 6129882, 9093943, 3734584, 3657139, 8779766, 3406054,
                        7739447, 4662227, 8158463, 5619844, 2639600, 9897074, 7264020, 5334754,
                        1440115, 237597, 2690220, 1379540, 5891999, 9344239, 4903183, 3743118,
                        353840, 2548797, 4250535, 5132947, 3894249, 2928871, 1986609, 7363850,
                        8634639, 2305009, 3831082, 7008725, 1192068, 1263645, 7045006, 6516238,
                        6033858, 627538, 4388590, 2544037, 4040167, 1596735, 6398051, 4447570,
                        1236229, 389379, 3087879, 7190031, 7891767, 5022925, 6835699, 7423250,
                        6018856, 6825255, 2757004, 7077505, 2192717, 842719, 8676224, 4575644,
                        4837267, 7673153, 7936124, 2900467, 1666737, 9477717, 1349040, 3370771,
                        6340208, 8038492, 3128997, 3539377, 1248333, 5988532, 5420311, 5712975,
                        4000003, 90117, 9341299, 7743291, 4074971, 371661, 6670684, 6668992,
                        4253561, 5727039, 6898794, 7001547, 7230434, 3144983, 7077524, 1560567,
                        7368780, 9891058, 2414793, 8638700, 4087892, 2286700, 8751148, 6493587,
                        6468075, 2494576, 5659289, 3424798, 1253178, 8099648, 9344701, 3760160,
                        548033, 4238200, 814126, 7192847, 739128, 8101397, 250002, 7497539, 3378586,
                        3739519, 159947, 2998211, 1595138, 153045, 5958994, 5329091, 829061,
                        8205367, 700124, 3985264, 800295, 4471368, 9716751, 9105402, 6325978,
                        9679339, 2550443, 6217947, 4303386, 1674308, 9099408, 3540809, 8667565,
                        9461564, 1553511, 8600547, 9947203, 7731629, 9937725, 6004163, 831511,
                        7865868, 9885920, 6060436, 9754676, 7013969, 3244345, 9810724, 80928,
                        7989516, 7644150, 102425, 2548947, 9945142, 661669, 5713955, 5099451,
                        7630253, 6621402, 3316367, 6515029, 3043796, 3051955, 8044013, 4465402,
                        5505601, 2379638, 7377739, 7260396, 1817403, 3138566, 4365544, 2477941,
                        7769176, 5557068, 2431728, 7421259, 5017467, 621956, 9982938, 7973608,
                        3513589, 3262483, 8812102, 8835341, 1727469, 5123422, 7607527, 5555429,
                        7764121, 4281187, 6826226, 918347, 2714004, 7200811, 6308587, 3797556,
                        8141669, 1551975, 7622249, 6757386, 1904782, 1508610, 2199988, 4833323,
                        9428163, 7279678, 6632766, 7987809, 2638099, 8825812, 4863580, 1610397,
                        3111979, 3864993, 6208024, 6668280, 5583759, 161275, 9179454, 6135395,
                        4010390, 7721525, 1310961, 4003462, 2854114, 3354765, 7683499, 8586160,
                        2951560, 9465829, 2228653, 460695, 3948454, 9347846, 9264351, 9880404,
                        3917801, 8140916, 8779865, 2430155, 1100291, 2776359, 8460580, 5214163,
                        5889138, 5740562, 5340371, 8036096, 7488019, 7378172, 148901, 6457843,
                        9193561, 5546015, 1292565, 6903334, 2771160, 1406098, 7329177, 336122,
                        8685562, 6418258, 5607056, 5839349, 3332630, 853948, 4731607, 900616,
                        1302678, 2090085, 9627756, 997068, 7821740, 9595899, 2402966, 1347972,
                        5126403, 8862945, 7626040, 8545137, 9444856, 1128898, 517044, 2724920,
                        7725330, 5083537, 3607512, 9806386, 1677535, 8823443, 5643572, 5561490,
                        4314756, 4495186, 5010532, 1812740, 7824649, 3975308, 1689684, 4110592,
                        508781, 9901313, 3223307, 8422947, 9426398, 254723, 4737745, 5517005,
                        5833566, 4713335, 1286575, 6756790, 6670234, 2070737, 8448162, 9531365,
                        248264, 8317585, 8165503, 3431173, 7329869, 1285356, 2119799, 246271,
                        1113521, 3561473, 4009189, 5167196, 9866458, 534108, 7561351, 2299708,
                        8653562, 3873501, 8907472, 2780305, 3117300, 7868792, 631665, 5948926,
                        3175557, 3844756, 9590242, 7264165, 9497076, 6027729, 7733887, 5101085,
                        5363162, 9304259, 2038516, 4749407, 6535524, 8780207, 8712308, 6588835,
                        9074798, 4254676, 2919588, 5734362, 5255632, 1612574, 1388729, 7336003,
                        7142106, 8592216, 3782865, 3366298, 5256935, 5586723, 1432251, 7950922,
                        3212511, 3205265, 4067936, 3233355, 117116, 4955194, 2636938, 4297582,
                        9590122, 3289136, 2434932, 5899471, 2286338, 9137352, 6931458, 552317,
                        1518570, 6602188, 7716301, 840801, 9668787, 1851387, 1366922, 9315929,
                        6721154, 2751346, 3941697, 7354432, 9935394, 1332415, 3807374, 9352842,
                        2311240, 4430055, 5523062, 180731, 3327959, 9616447, 5702758, 4480755,
                        4875255, 1748480, 8820032, 8996110, 3587340, 3832731, 9290443, 6395586,
                        9457654, 5009495, 9632070, 7179566, 4468268, 4030564, 1414498, 2571784,
                        1452267, 8454231, 4823035, 9225557, 7397164, 9641908, 1342056, 8483043,
                        4677346, 2503135);
        //1724474178
        System.out.println(obj.maxProfit(list1));
    }
}
